---
title: "Curso de Estat√≠stica com R para Experimenta√ß√£o Agr√≠cola"
format:
  html:
    toc: true           # habilita o menu de t√≥picos
    toc-location: left  # coloca o menu na lateral esquerda
    toc-depth: 3        # mostra at√© n√≠vel de subt√≥picos
    theme: cosmo        # tema da p√°gina
---



# Come√ßando a programar em <i class="fa-brands fa-r-project"></i> {#exemplos-de-c√≥digos}

## üîπ M√≥dulo 1 ‚Äì Introdu√ß√£o ao R e Organiza√ß√£o de Dados

### Aula 1 ‚Äì Instala√ß√£o e primeiros passos

-   Instale o R e o RStudio em seu computador.\

O **R** √© o programa principal, ou seja, a linguagem de programa√ß√£o e o ambiente de c√°lculo.\
√â nele que todos os comandos s√£o processados e as an√°lises estat√≠sticas s√£o realizadas.\
Por isso, o primeiro passo √© instalar o R no computador.\
O download deve ser feito diretamente no site oficial do CRAN (Comprehensive R Archive Network):

<i class="fa-brands fa-r-project"></i> <https://cran.r-project.org/>

Ao abrir o link, basta escolher o sistema operacional do seu computador (Windows, macOS ou Linux) e seguir as instru√ß√µes de instala√ß√£o.\
Com isso, voc√™ j√° ter√° o R funcionando, embora a sua interface seja bastante simples e pouco intuitiva para quem est√° come√ßando.

√â justamente nesse ponto que entra o **RStudio**.\
O RStudio n√£o √© um programa separado do R, mas sim uma **IDE (Integrated Development Environment)**, ou seja, um ambiente de desenvolvimento que facilita o uso do R.\
Ele oferece uma interface gr√°fica amig√°vel, onde voc√™ pode escrever c√≥digos, visualizar gr√°ficos, organizar projetos e instalar pacotes com muito mais facilidade.

No entanto, √© fundamental compreender que o RStudio **n√£o funciona sozinho**.\
Ele depende do R j√° instalado na m√°quina, pois √© o R quem executa de fato os c√°lculos.\
Por isso, a ordem correta √©: primeiro instalar o R e, em seguida, instalar o RStudio.

O download do RStudio pode ser feito no site oficial da Posit (empresa respons√°vel pelo software):

üëâ <https://posit.co/download/rstudio-desktop/>

Ao instalar os dois programas, voc√™ ter√° o **R** como motor de c√°lculo e o **RStudio** como painel de controle, trabalhando em conjunto.\
Essa combina√ß√£o √© a mais utilizada no mundo acad√™mico e profissional para an√°lises estat√≠sticas e ci√™ncia de dados.

-   Conhe√ßa os principais pain√©is do RStudio:
    -   *Console* (execu√ß√£o de comandos)\
    -   *Source* (script)\
    -   *Environment/History* (objetos)\
    -   *Plots/Packages/Help*

**Verificando vers√£o do R**

```{r}
# Verificando vers√£o do R
version
```

**Citando o R**

```{r}
# Cita√ß√£o do R
citation()
```

**Opera√ß√µes simples**

```{r}
# Opera√ß√µes simples

## Soma
2 + 2

## Subtra√ß√£o
7 - 2

## Mutiplica√ß√£o
4 * 3

## Divis√£o
10 / 3

## Raiz quadrada
sqrt(25)
```

------------------------------------------------------------------------

### Aula 2 ‚Äì Objetos no R

Nesta aula, aprendemos a criar e manipular objetos no R. Objetos s√£o vari√°veis que armazenam valores ou resultados de c√°lculos, permitindo que possamos reutiliz√°-los em outras opera√ß√µes.

No exemplo apresentado, criamos dois objetos num√©ricos:

```{r}
# Criando objetos
x <- 5
y <- 10
```

Aqui, x recebe o valor 5 e y recebe o valor 10. Em seguida, criamos um terceiro objeto chamado soma, que armazena a soma de x e y:

```{r}
soma <- x + y
soma
```

Ao digitar apenas soma, o R retorna o valor armazenado neste objeto, que neste caso √© 15.

Este exemplo ilustra a forma b√°sica de criar objetos no R e realizar opera√ß√µes simples com eles, fundamental para qualquer an√°lise de dados ou programa√ß√£o no software.

------------------------------------------------------------------------

### Aula 3 ‚Äì Pacotes

No R, os pacotes s√£o conjuntos de fun√ß√µes, dados e recursos que estendem as capacidades b√°sicas do software, permitindo realizar an√°lises mais complexas de forma pr√°tica e eficiente.

No exemplo abaixo, veja como instalar alguns pacotes importantes um de cada vez:

```{r}
#| message: false
#| warning: false
#| eval: false

# Carregando pacotes
install.packages("tidyverse")   # Para manipula√ß√£o e visualiza√ß√£o de dados
install.packages("dplyr")   # Para manipula√ß√£o e visualiza√ß√£o de dados
install.packages("readxl")      # Para ler arquivos do Excel
install.packages("ExpDes.pt")   # Para planejamento e an√°lise de experimentos agr√≠colas
install.packages("easyanova")   # Para facilitar an√°lises de vari√¢ncia
install.packages("rstatix")     # Para estat√≠sticas descritivas e testes inferenciais
install.packages("emmeans")     # Para estat√≠sticas descritivas e testes inferenciais
install.packages("janitor")     # Para limpeza e organiza√ß√£o de dados
install.packages("kableExtra")  # Para tabelas formatadas

```

Ouse preferir pode instalar v√°rios de uma √∫nica vez:

```{r}
#| message: false
#| warning: false
#| eval: false

# Carregando pacotes
install.packages("tidyverse", "readxl", "ExpDes.pt", "easyanova", "rstatix", "emmeans", "janitor", "kableExtra")

```

No exemplo abaixo, carregamos alguns pacotes importantes:

```{r}
#| message: false
#| warning: false

# Carregando pacotes

# ---------------------------
# Pacotes para manipula√ß√£o e leitura de dados
# ---------------------------
library(tidyverse)   # Inclui dplyr, ggplot2, readr, tidyr, etc.
library(dplyr)       # Manipula√ß√£o de dados
library(readxl)      # Para importar planilhas Excel

# ---------------------------
# Pacotes para an√°lise de experimentos
# ---------------------------
library(ExpDes.pt)   # ANOVA para DIC, DBC, parcelas subdivididas etc.
library(easyanova)   # ANOVA e testes complementares de forma simplificada

# ---------------------------
# Pacotes para estat√≠stica e p√≥s-testes
# ---------------------------
library(rstatix)     # Testes estat√≠sticos (normalidade, homogeneidade, etc.)
library(emmeans)     # M√©dias ajustadas e compara√ß√µes m√∫ltiplas

# ---------------------------
# Pacotes para organiza√ß√£o e visualiza√ß√£o de dados
# ---------------------------
library(janitor)     # Limpeza e organiza√ß√£o de dados
library(kableExtra)  # Tabelas formatadas

```

------------------------------------------------------------------------

### Aula 4 - Organiza√ß√£o e Padroniza√ß√£o dos Dados

Um dos passos mais importantes em qualquer an√°lise √© a **organiza√ß√£o adequada dos dados**. Dados desorganizados ou com nomes de vari√°veis inconsistentes podem dificultar o trabalho, aumentar a chance de erros e at√© inviabilizar o uso de fun√ß√µes em softwares estat√≠sticos como o R.

Veja esse esse exmeplo de banco de dados (`dados_ruins_dic`) no Excel:

```{r}
#| include: false
# Banco com nomes pouco apropriados (exemplo did√°tico)
dados_ruins_dic <- data.frame(
  `Tratamento (Aduba√ß√£o)` = rep(c("T1 - Testemunha", 
                                  "T2 - 50kg N", 
                                  "T3 - 100kg N", 
                                  "T4 - 150kg N"), each = 5),
  "Repeti√ß√£o" = rep(1:5, times = 4),
  "Altura da planta (cm)" = c(
    160, 165, 158, 162, 161,   # T1 (testemunha, mais baixo)
    180, 185, 178, 182, 184,   # T2
    200, 205, 198, 202, 201,   # T3
    220, 225, 218, 222, 221    # T4 (maior aduba√ß√£o)
  ),
  "Mat√©ria seca (g)" = c(
    280, 300, 290, 295, 285,   # T1
    360, 370, 365, 368, 362,   # T2
    450, 460, 455, 465, 458,   # T3
    550, 560, 545, 555, 548    # T4
  )
)

# Ajustando nomes das colunas para ficarem bonitos no Excel
colnames(dados_ruins_dic) <- c("Repeti√ß√£o", "Tratamento", "Altura da planta (cm)", "Mat√©ria seca (g)")
```

```{r}
#| echo: false
dados_ruins_dic |> 
  kableExtra::kable() |> 
  kableExtra::kable_paper(html_font = "Arial")
```

**Import√¢ncia de bons t√≠tulos nas vari√°veis**

No R, os **nomes das colunas** (ou t√≠tulos das vari√°veis) devem seguir algumas boas pr√°ticas para facilitar a an√°lise:

-   **Padr√£o `snake_case`**: usar letras min√∫sculas e sublinhados para separar palavras, como `altura_planta_g`.
-   **Evitar espa√ßos**: em vez de `Altura da Planta`, utilizar `Altura_Planta`.\
-   **Usar unidades no nome da vari√°vel**: em vez de `Altura da Planta (cm)`, utilizar `Altura_Planta_cm`.\
-   **Usar letras min√∫sculas** (ou padr√£o definido): `altura_planta_cm`.\
-   **Evitar acentos e caracteres especiais**: em vez de `Mat√©ria seca (g)`, utilizar `materia_seca_g`.\
-   **Ser descritivo, mas n√£o excessivamente longo**: `peso_frutos` em vez de `pf_colheita_experimental_2024`.

Esses cuidados tornam o banco de dados mais **limpo, reprodut√≠vel e compat√≠vel com fun√ß√µes e pacotes do R**.

**Como organizar os t√≠tulos**

1.  **Pode fazer manulamente no Excel**
    -   Antes de importar o arquivo para o R, pode-se renomear diretamente no Excel.\
    -   Exemplo: renomear a coluna de `Massa seca total (g)` para `massa_seca_total_g`.
2.  **Manualmente no R usando o pacote `dplyr`**

A fun√ß√£o `rename()` do pacote dplyr permite renomear manualmente colunas espec√≠ficas.

```{r}
# Renomear colunas espec√≠ficas
library(dplyr)
dados_organizados_dplyr <- dados_ruins_dic |>
  rename(
    repeticao = `Repeti√ß√£o`,
    tratamento = Tratamento,
    altura_planta_cm = `Altura da planta (cm)`,
    materia_seca_g = `Mat√©ria seca (g)`
  )
```

```{r}
#| echo: false
# Ver banco de dados
dados_organizados_dplyr |> 
  kableExtra::kable() |> 
  kableExtra::kable_paper(html_font = "Arial")
```

Nomes antes:

```{r}
# Ver como eram
names(dados_ruins_dic)
```

Nomes depois:

```{r}
# Ver como ficaram
names(dados_organizados_dplyr)
```

3.  **Autom√°tico usando o pacote `janitor`**\
    Existem pacotes que auxiliam na padroniza√ß√£o dos nomes de maneira autom√°tica:

    -   Pacote **`janitor`**: a fun√ß√£o `clean_names()` desse pacote converte automaticamente os t√≠tulos para um formato padr√£o (`snake_case`).

Veja o que acontece com esse banco de dados (`dados_ruins_dic`):

```{r}
# Corrigir nomes das colunas -> formato "snake_case"
dados_organizados_janitor <- dados_ruins_dic |> 
  janitor::clean_names()
```

```{r}
#| echo: false
# Ver banco de dados
dados_organizados_janitor |> 
  kableExtra::kable() |> 
  kableExtra::kable_paper(html_font = "Arial")
```

Nomes antes:

```{r}
# Ver como eram
names(dados_ruins_dic)
```

Nomes depois:

```{r}
# Ver como ficaram
names(dados_organizados_janitor)
```

------------------------------------------------------------------------

### Aula 5 ‚Äì Importa√ß√£o de Dados

**Importando dados**

Importar dados para o R √© um passo fundamental para qualquer an√°lise. No R, √© poss√≠vel importar dados de diferentes formatos, o que √© essencial para iniciar qualquer an√°lise. O R permite ler diferentes formatos de arquivos, como CSV e Excel.

```{r}

# Importando CSV
# dados_csv <- read.csv("meus_dados.csv", sep = ";", dec = ",")
# L√™ arquivos CSV, permitindo especificar o separador de colunas (sep) e o separador decimal (dec)

# Importando Excel
# dados_excel <- readxl::read_excel("meus_dados.xlsx")
# L√™ planilhas do Excel diretamente para o R

# Importando arquivo de texto (TXT)
# dados_txt <- read.table("meus_dados.txt", header = TRUE, sep = "\t", dec = ".")
# L√™ arquivos de texto, onde 'header = TRUE' indica que a primeira linha cont√©m os nomes das colunas,
# 'sep = "\t"' indica que as colunas s√£o separadas por tabula√ß√£o, e 'dec = "."' define o separador decimal

```

-   `read.csv()` l√™ arquivos no formato CSV (Comma-Separated Values), permitindo especificar o separador de colunas (sep) e o separador decimal (dec). √â indicado para planilhas exportadas como CSV ou dados gerados por outros programas.

-   `read_excel()` (do pacote `readxl`) l√™ arquivos do Excel (.xls ou .xlsx) diretamente, mantendo nomes das colunas e tipos de dados corretamente, o que facilita a importa√ß√£o de planilhas complexas sem precisar convert√™-las.

-   `read.table()` l√™ arquivos de texto simples (TXT ou outros delimitados), oferecendo flexibilidade para especificar se h√° cabe√ßalho (header = TRUE), o separador de colunas (sep) e o separador decimal (dec). √â ideal para arquivos de texto com diferentes formatos de separa√ß√£o.

**Visualizando os dados**

Ap√≥s a importa√ß√£o, podemos visualizar os dados para verificar se foram carregados corretamente: Ap√≥s a importa√ß√£o, √© importante visualizar os dados para conferir se foram carregados corretamente. Para isso, podem ser usadas fun√ß√µes como:

-   `head()` (exibe as primeiras linhas),
-   `summary()` (mostra resumo estat√≠stico das vari√°veis),
-   `str()` (mostra a estrutura do objeto) e
-   `glimpse()` (exibe de forma compacta e leg√≠vel a estrutura e os tipos das vari√°veis).

```{r}

# head(dados_csv)    # Mostra as primeiras linhas do conjunto de dados
# summary(dados_csv) # Mostra um resumo estat√≠stico das vari√°veis
# str(dados_csv)     # Mostra a estrutura do objeto, incluindo tipos de vari√°veis e dimens√µes
# glimpse(dados_csv)  # Mostra todas as vari√°veis, seus tipos e algumas observa√ß√µes de cada coluna

```

------------------------------------------------------------------------

## üîπ M√≥dulo 2 ‚Äì Manipula√ß√£o e Explora√ß√£o de Dados

### Aula 6 ‚Äì Tipos de Vari√°veis em R

1.  **Vari√°veis num√©ricas**
    -   **Cont√≠nuas (`numeric` / `dbl`)**: podem assumir qualquer valor dentro de um intervalo, incluindo decimais.\
        **Exemplo:** Produtividade (t/ha), √Årea (m¬≤)
    -   **Discretas (`integer` / `int`)**: assumem apenas valores inteiros.\
        **Exemplo:** Parcela (identificador das parcelas)
2.  **Vari√°veis categ√≥ricas (fatores) (`factor` / `fct`)**
    -   Representam categorias ou grupos que o R reconhece para an√°lises estat√≠sticas.\
        **Exemplo:** Tratamento, Variedade\
    -   Ideais para an√°lise de vari√¢ncia e compara√ß√µes entre grupos
3.  **Vari√°veis de texto (`character` / `chr`)**
    -   Cont√™m informa√ß√µes textuais ou descritivas, que n√£o t√™m ordem ou significado num√©rico.\
        **Exemplo:** Local (Norte, Sul, Leste)\
    -   N√£o s√£o usadas diretamente em c√°lculos estat√≠sticos, mas servem para identificar ou agrupar dados
4.  **Vari√°veis l√≥gicas (`logical` / `logi`)**
    -   Assumem apenas dois valores: `TRUE` ou `FALSE`\
        **Exemplo:** Irrigado\
    -   √öteis para condi√ß√µes, filtros e an√°lises condicionais
5.  **Outros tipos dispon√≠veis em R**
    -   **Complexo (`complex` / sem abrevia√ß√£o comum)**: n√∫meros complexos, como `1+2i`
    -   **Raw (`raw` / sem abrevia√ß√£o comum)**: representa dados brutos em bytes\
    -   **Date (`Date` / sem abrevia√ß√£o comum)**: datas no formato `"YYYY-MM-DD"`\
    -   **POSIXct / POSIXlt (`POSIXct` / `POSIXlt`)**: datas e horas com tempo
    -   **Ordered factor (`ordered` / `ord`)**: fatores com ordem natural definida

------------------------------------------------------------------------

Neste exemplo, iremos **criar vari√°veis de diferentes tipos** em R ‚Äî num√©ricas cont√≠nuas, num√©ricas discretas e categ√≥ricas (fatores) ‚Äî e, em seguida, **identificar o tipo de cada vari√°vel** usando a fun√ß√£o `class()`.

Isso nos permite compreender como o R armazena cada tipo de dado e como ele ser√° tratado em an√°lises estat√≠sticas.

```{r}
# Num√©rica cont√≠nua
num_cont <- 3.5      # numeric / dbl
class(num_cont) # Checando classes

# Num√©rica discreta
num_disc <- 5L       # integer / int
class(num_disc)

# Fator (categ√≥rica)
trat <- factor(c("T1", "T2", "T3"))  # factor / fct
class(trat)

# Ordered factor
ord_trat <- factor(c("Baixo", "M√©dio", "Alto"), ordered = TRUE) # ordered / ord
class(ord_trat)

# Character
local <- c("Norte", "Sul")  # character / chr
class(local)

# L√≥gica
irr <- c(TRUE, FALSE)       # logical / logi
class(irr)

# Complexo
cplx <- 1 + 2i              # complex
class(cplx)

# Raw
r <- charToRaw("A")         # raw
class(r)

# Datas
d <- as.Date("2025-08-29")  # Date
class(d)

dt <- as.POSIXct("2025-08-29 12:00:00") # POSIXct
class(dt)

```

<br>

**Criando banco de dados fict√≠cio**

Neste exemplo, iremos **criar um banco de dados fict√≠cio de um experimento agr√≠cola** com diferentes tipos de vari√°veis: num√©ricas (cont√≠nuas e discretas), categ√≥ricas, l√≥gicas e de texto.

Em seguida, iremos **visualizar o banco de dados e identificar os tipos de vari√°veis**, para entender como o R armazena cada tipo e como podemos manipul√°-las em an√°lises estat√≠sticas.

```{r}
# Exemplo de banco de dados de experimento agr√≠cola
dados_agro <- data.frame(
  Parcela = 1:9,                               # Num√©rica discreta (identifica√ß√£o das parcelas)
  Tratamento = factor(rep(c("T1", "T2", "T3"), each = 3)), # Fator (categ√≥rica nominal)
  Variedade = factor(c("A", "A", "A", "B", "B", "B", "C", "C", "C")), # Fator (categ√≥rica nominal)
  Area = c(10, 10, 10, 12, 12, 12, 11, 11, 11),  # Num√©rica cont√≠nua (m¬≤)
  Produtividade = c(30.5, 32.0, 31.0, 28.0, 29.5, 30.0, 33.0, 34.5, 32.5), # Num√©rica cont√≠nua (t/ha)
  Irrigado = c(TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE),   # L√≥gica
  Local = c("Norte", "Norte", "Norte", "Sul", "Sul", "Sul", "Leste", "Leste", "Leste") # Texto (character)
)

```

```{r}
# Exemplo de banco de dados de experimento agr√≠cola
dados_agro <- data.frame(
  Parcela = 1:9,                               # Num√©rica discreta (identifica√ß√£o das parcelas)
  Tratamento = rep(c("T1", "T2", "T3"), each = 3), # Fator (categ√≥rica nominal)
  Variedade = c("A", "A", "A", "B", "B", "B", "C", "C", "C"), # Fator (categ√≥rica nominal)
  Area = c(10, 10, 10, 12, 12, 12, 11, 11, 11),  # Num√©rica cont√≠nua (m¬≤)
  Produtividade = c(30.5, 32.0, 31.0, 28.0, 29.5, 30.0, 33.0, 34.5, 32.5), # Num√©rica cont√≠nua (t/ha)
  Irrigado = c(TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE),   # L√≥gica
  Local = c("Norte", "Norte", "Norte", "Sul", "Sul", "Sul", "Leste", "Leste", "Leste") # Texto (character)
)
```

<br>

**Fun√ß√µes para Visualiza√ß√£o e Estrutura de Dados no R**

1.  **`head(dados_agro)`**\
    Mostra as **primeiras linhas** do conjunto de dados.
    -   √ötil para ter uma **vis√£o r√°pida** do conte√∫do do banco, verificando se os dados foram importados corretamente.\
    -   Exemplo de sa√≠da:

```{r}
head(dados_agro) 
```

<br>

2.  **`str(dados_agro)`**

Mostra a **estrutura do objeto**, permitindo entender rapidamente como os dados est√£o organizados no R.

Com essa fun√ß√£o, √© poss√≠vel:

-   Ver o **n√∫mero de observa√ß√µes** (linhas) e o **n√∫mero de vari√°veis** (colunas) do banco de dados, por exemplo, `9 obs. of 7 variables`.\
-   Identificar o **tipo de cada vari√°vel**, como `int` (inteiro), `num` (num√©rico cont√≠nuo), `Factor` (categ√≥rica), `logi` (l√≥gica/boolean) e `chr` (texto).\
-   Conferir **alguns valores iniciais de cada coluna**, ajudando a verificar se os dados foram importados corretamente e se os tipos est√£o adequados para an√°lise.

Em resumo, `str()` √© uma fun√ß√£o essencial para **inspecionar rapidamente a estrutura e os tipos das vari√°veis**, antes de realizar qualquer an√°lise estat√≠stica ou manipula√ß√£o dos dados.

```{r}
str(dados_agro)

```

Observe que **Tratamento** e **Variedade** aparecem como `character`, ou seja, texto.\
Para an√°lises estat√≠sticas, √© recomendado transformar essas vari√°veis em fatores.

<br>

3.  **`summary(dados_agro)`**

Mostra um **resumo estat√≠stico** das vari√°veis:\
- Para vari√°veis num√©ricas: m√≠nimo, m√°ximo, m√©dia, quartis\
- Para fatores: contagem de cada n√≠vel\
- Para l√≥gicas: contagem de `TRUE` e `FALSE`\
- √ötil para identificar tend√™ncias, valores extremos e distribui√ß√£o dos dados.

```{r}
summary(dados_agro)

```

Veja novamente que **Tratamento** e **Variedade** aparecem como `character`.\
E n√£o s√£o reconhecidas como fatores.\
E n√£o √© poss√≠vel perceber quais s√£o os n√≠veis de cada vari√°vel categ√≥rica.\

**Convertendo variaveis categ√≥ricas em fatores**

1.  Pode-se convert√™-las em fatores usando a fun√ß√£o `as.factor()`:

```{r}
dados_agro$Tratamento <- as.factor(dados_agro$Tratamento)
dados_agro$Variedade <- as.factor(dados_agro$Variedade)
```

Agora veja como fica a **estrutura** dos dados:

```{r}
str(dados_agro)
```

Agora sim, Tratamento e variedade aparecem como `Factor` com 3 n√≠veis cada.

veja como fica o **resumo estat√≠stico** dos dados:

```{r}
summary(dados_agro)
```

Agora √© poss√≠vel ver a contagem de cada n√≠vel das vari√°veis categ√≥ricas. Ou seja, s√£o 3 n√≠veis em cada vari√°vel (T1, T2, T3 para Tratamento e A, B, C para Variedade).

2.  Pode-se convert√™-las em fatores usando a fun√ß√£o `factor()`:

Tamb√©m d√° para criar o fator diretamente com a fun√ß√£o `factor()`, que √© mais flex√≠vel porque permite:

-   Definir os n√≠veis (`levels`)
-   Definir as etiquetas (`labels`)

Ou seja, permite controlar a ordem e o r√≥tulo dos n√≠veis (mais recomendado para ANOVA e modelos, pois evita ordem alfab√©tica indesejada).

```{r}
#| include: false
#| echo: true


dados_agro$Tratamento <- factor(
  dados_agro$Tratamento,
  levels = c("T1", "T2", "T3"),                 # ordem dos n√≠veis
  labels = c("Controle", "Adubo", "Bioestimulante") # nomes leg√≠veis
)

dados_agro$Variedade <- factor(
  dados_agro$Variedade,
  levels = c("A", "B", "C"),
  labels = c("IPA 11", "Campo Lindo", "Mata-Hari") # nomes reais das variedades
)

str(dados_agro)
```

3.  Pode-se ainda convert√™-las em fatores usando a fun√ß√£o `convert_as_factor()` do pacote {rstatix}:

A fun√ß√£o `convert_as_factor()` pode converter uma ou v√°rias colunas ao mesmo tempo.

```{r}
#| warning: false
#| include: false
#| echo: true

library(rstatix)

dados_agro <- dados_agro |> 
  convert_as_factor(Tratamento, Variedade)

```

<br>

4.  **`glimpse(dados_agro)`** (do pacote `dplyr`)

Mostra a **estrutura dos dados de forma compacta e leg√≠vel**, similar ao `str()`, mas em formato horizontal:

-   Exibe todas as vari√°veis, seus tipos e algumas observa√ß√µes iniciais\
-   Mais f√°cil de ler quando o banco de dados tem muitas colunas

Exemplo de sa√≠da (resumida):

```{r}
glimpse(dados_agro)

```

------------------------------------------------------------------------

### Aula 7 ‚Äì Manipula√ß√£o com dplyr

```{r}
# Exemplo fict√≠cio
dados <- data.frame(
  tratamento = rep(c("T1", "T2", "T3"), each = 4),
  repeticao = rep(1:4, 3),
  produtividade = c(30, 32, 28, 31, 35, 36, 34, 37, 25, 27, 26, 28)
)

# Selecionar colunas e filtrar
dados |> dplyr::select(tratamento, produtividade) |> filter(produtividade > 30)

# Resumo estat√≠stico
dados |>
  group_by(tratamento) |>
  summarise(
    media = mean(produtividade),
    sd = sd(produtividade)
  )
```

------------------------------------------------------------------------

### Aula 8 ‚Äì Estat√≠stica Descritiva e Gr√°ficos

```{r}
# Histograma
ggplot(dados, aes(x = produtividade)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "black")

# Boxplot
ggplot(dados, aes(x = tratamento, y = produtividade)) +
  geom_boxplot(fill = "orange")

```

------------------------------------------------------------------------

## üîπ M√≥dulo 3 ‚Äì An√°lise de Vari√¢ncia (ANOVA)

### Aula 9 ‚Äì ANOVA em DIC

```{r}
# Primeiro transformar vari√°veis em fatores
dados$tratamento <- factor(dados$tratamento)
dados$repeticao <- factor(dados$repeticao)

# ANOVA usando aov()
modelo <- aov(produtividade ~ tratamento, data = dados)
summary(modelo)


# ANOVA usando rstatix
dados |> anova_test(produtividade ~ tratamento)


# ANOVA usando ExpDes.pt
dic(
  trat = dados$tratamento,
  resp = dados$produtividade,
  quali = TRUE,
  mcomp = "tukey"
)

# ANOVA usando easyanova
easyanova::ea1(dados[-2], design = 1, plot = 2)
```

**Testes de Pressupostos**

Antes da an√°lise de vari√¢ncia (ANOVA), foi realizada a verifica√ß√£o dos pressupostos de **normalidade dos res√≠duos** e **homogeneidade das vari√¢ncias**, que s√£o condi√ß√µes necess√°rias para a validade do teste F.

**Normalidade dos res√≠duos**

-   O **teste de Shapiro-Wilk** foi aplicado sobre os res√≠duos do modelo, verificando se a distribui√ß√£o se aproxima da normal.
-   Al√©m disso, a normalidade foi testada dentro de cada grupo experimental utilizando a fun√ß√£o `shapiro_test()` do pacote **rstatix**, o que permite avaliar poss√≠veis desvios em tratamentos espec√≠ficos.
-   Quando o valor de *p* \> 0,05, n√£o se rejeita a hip√≥tese nula de normalidade, indicando que os res√≠duos podem ser considerados normalmente distribu√≠dos.

```{r}
# Normalidade
shapiro.test(residuals(modelo))

# Usando pacote rstatix e fazendo normalidade por grupo
dados |> group_by(tratamento) |> rstatix::shapiro_test(produtividade)
```

**Homogeneidade das vari√¢ncias**

-   Para verificar se os tratamentos apresentam vari√¢ncias homog√™neas, foram aplicados tr√™s testes:
    -   **Teste de Bartlett**: sens√≠vel a desvios de normalidade, mas adequado quando os dados s√£o normais.
    -   **Teste de Levene**: mais robusto quando a normalidade n√£o √© estritamente atendida.

```{r}
# Homogeneidade
## Teste de Bartlett
bartlett.test(produtividade ~ tratamento, data = dados)

## Teste de Levene
rstatix::levene_test(produtividade ~ tratamento, data = dados)
```

> Em todos os testes, valores de *p* \> 0,05 indicam que n√£o h√° evid√™ncias para rejeitar a hip√≥tese de homogeneidade das vari√¢ncias, atendendo ao pressuposto da ANOVA.

Dessa forma, a an√°lise de vari√¢ncia pode ser conduzida com confian√ßa, uma vez que os pressupostos de normalidade e homogeneidade foram verificados.

**Compara√ß√µes de M√©dias**

```{r}
# Tukey no R base
TukeyHSD(modelo)

# Tukey no rstatix
dados |> tukey_hsd(produtividade ~ tratamento)


# M√©dias ajustadas
# Emmeans
emm <- emmeans(modelo, ~ tratamento)
grupos <- multcomp::cld(emm, Letters = letters, adjust = "tukey")
print(grupos)

```

------------------------------------------------------------------------

### Aula 10 ‚Äì ANOVA em DBC

**Anova**

No DBC (delineamento em blocos casualizados) a diferen√ßa principal √© que voc√™ precisa considerar o efeito de blocos no modelo. Seguindo o mesmo estilo da sua aula de DIC, aqui est√° a vers√£o para DBC:

```{r}
# ANOVA usando aov()
# Aqui usamos Error(bloco) ou bloco como efeito
modelo <- aov(produtividade ~ tratamento + repeticao, data = dados)
summary(modelo)

# ANOVA usando rstatix
dados |> anova_test(produtividade ~ tratamento + repeticao)

# ANOVA usando ExpDes.pt
dbc(
  trat = dados$tratamento,
  bloco = dados$repeticao,
  resp = dados$produtividade,
  quali = TRUE,
  mcomp = "tukey"
)

# ANOVA usando easyanova
# design = 2 corresponde a DBC
easyanova::ea1(dados, design = 2, plot = 2)

```

Observa√ß√µes importantes:

-   No `aov()`, o termo `+ bloco` garante que a varia√ß√£o entre blocos seja considerada.
-   No `ExpDes.pt`, usamos `dbc()` no lugar de `dic()`.
-   No `easyanova`, o argumento `design = 2` √© usado para DBC.

**Testes de Pressupostos**

```{r}
# Normalidade
shapiro.test(residuals(modelo))

# Usando pacote rstatix e fazendo normalidade por grupo
dados |> group_by(tratamento) |> rstatix::shapiro_test(produtividade)

# Homogeneidade
## Teste de Bartlett
bartlett.test(produtividade ~ tratamento, data = dados)

## Teste de Levene
rstatix::levene_test(produtividade ~ tratamento, data = dados)

## Teste de ONeill e Mathews
oneilldbc(trat = dados$tratamento, resp = dados$produtividade, bloco = dados$repeticao)
```

Em DBC tamb√©m foi realizado **Teste de O‚ÄôNeill e Mathews**, espec√≠fico para experimentos em blocos casualizados (DBC), sendo recomendado como alternativa robusta para esse delineamento.

> Em todos os testes, valores de *p* \> 0,05 indicam que n√£o h√° evid√™ncias para rejeitar a hip√≥tese de homogeneidade das vari√¢ncias, atendendo ao pressuposto da ANOVA.

**Compara√ß√µes de M√©dias**

```{r}
# Tukey no R base
TukeyHSD(modelo)

# Tukey no rstatix
dados |> tukey_hsd(produtividade ~ tratamento)


# M√©dias ajustadas
# Emmeans
emm <- emmeans(modelo, ~ tratamento)
grupos <- multcomp::cld(emm, Letters = letters, adjust = "tukey")
print(grupos)

```

------------------------------------------------------------------------

### Aula 11 ‚Äì ANOVA Fatorial em DIC

```{r}
# Exemplo com dois fatores
dados2 <- expand.grid(
  adubacao = c("A1", "A2"),
  cultivar = c("C1", "C2", "C3"),
  rep = 1:4
)

set.seed(123)

dados2$produtividade <- rnorm(24, mean = 30, sd = 3)
dados2$adubacao <- factor(dados2$adubacao)
dados2$cultivar <- factor(dados2$cultivar)
dados2$rep <- factor(dados2$rep)

# ANOVA usando aov()
modelo2 <- aov(produtividade ~ adubacao * cultivar, data = dados2)
summary(modelo2)

# rstatix
dados2 |> anova_test(produtividade ~ adubacao * cultivar)


# ExpDes.pt
fat2.dic(
  fator1 = dados2$adubacao,
  fator2 = dados2$cultivar,
  resp = dados2$produtividade,
  quali = c(TRUE, TRUE),
  mcomp = "tukey"
)


# easyanova
easyanova::ea2(dados2[-3], design = 1, plot = 2)

```

------------------------------------------------------------------------

### Aula 12 ‚Äì ANOVA Fatorial em DBC

```{r}
# ANOVA usando aov()
# Aqui, bloco √© adicionado como efeito de erro
modelo_dbc <- aov(produtividade ~ rep + adubacao * cultivar, data = dados2)
summary(modelo_dbc)

# rstatix
dados2 |> anova_test(produtividade ~ rep + adubacao * cultivar)

# ExpDes.pt
# fat2.dbc √© a fun√ß√£o para fatorial em blocos no pacote ExpDes.pt
fat2.dbc(
  bloco = dados2$rep,
  fator1 = dados2$adubacao,
  fator2 = dados2$cultivar,
  resp = dados2$produtividade,
  quali = c(TRUE, TRUE),
  mcomp = "tukey"
)

# easyanova
# Em DBC, design = 2 (fatorial em blocos)
easyanova::ea2(dados2, design = 2, plot = 2)
```

------------------------------------------------------------------------

## üîπ M√≥dulo 4 ‚Äì Regress√£o

### Aula 13 ‚Äì Regress√£o Linear

```{r}
dose <- c(0, 50, 100, 150, 200)
prod <- c(20, 28, 35, 40, 38)
dados_reg <- data.frame(dose, prod)

modelo_reg <- lm(prod ~ dose, data = dados_reg)
a <- summary(modelo_reg)

# Coeficientes
coeficientes <- coef(modelo_reg)
intercepto <- round(coeficientes[1], 2) # sem sinal extra
slope <- formatC(coeficientes[2], format = "f", digits = 2, flag = "+") # sempre com sinal

# Estat√≠sticas do modelo
r2 <- round(a$r.squared, 4)
f_value <- a$fstatistic[1]
df1 <- a$fstatistic[2]
df2 <- a$fstatistic[3]
p_value_anova <- pf(f_value, df1, df2, lower.tail = FALSE)




# Equa√ß√£o no formato correto
equacao <- paste0("y = ", intercepto, slope, "x")

legenda <- paste0(
  equacao,
  "  R¬≤ = ", r2,
  "\nF = ", f_value,
  "; p = ", format.pval(p_value_anova, digits = 4, eps = 0.001)
)



dados_reg |>
  ggplot(aes(x = dose, y = prod)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = FALSE, color = "black") +
  annotate("text",
           x = 100, y = 10,
           label = legenda,
           hjust = 0, size = 5) +
  labs(x = "Frequ√™ncia de irriga√ß√£o", y = "CRA (%)") +
  theme_bw() +
  theme(panel.grid = element_blank()) +
  ylim(0, 50)

```

------------------------------------------------------------------------

### Aula 14 ‚Äì Regress√£o Quadr√°tica

```{r}
# Ajustar modelo de regress√£o quadr√°tica
modelo_quad <- lm(prod ~ dose + I(dose^2), data = dados_reg)
a <- summary(modelo_quad)
a
# Coeficientes da regress√£o quadr√°tica (com mais casas decimais)
coef_quad <- coef(modelo_quad)
intercepto <- formatC(coef_quad[1], format = "f", digits = 4)
linear     <- formatC(coef_quad[2], format = "f", digits = 4, flag = "+")
quadratico <- formatC(coef_quad[3], format = "f", digits = 4, flag = "+") 
# usei 6 casas para o termo quadr√°tico porque geralmente √© bem pequeno

# Estat√≠sticas do modelo
r2 <- round(a$r.squared, 4)
f_value <- a$fstatistic[1]
df1 <- a$fstatistic[2]
df2 <- a$fstatistic[3]
p_value_anova <- pf(f_value, df1, df2, lower.tail = FALSE)

# Equa√ß√£o para legenda
equacao <- paste0("y = ", intercepto, " ", linear, "x ", quadratico, "x¬≤")
legenda <- paste0(
  equacao,
  "  R¬≤ = ", r2,
  "\nF = ", round(f_value, 2),
  "; p = ", format.pval(p_value_anova, digits = 4, eps = 0.001)
)

# Gr√°fico
library(ggplot2)

regressao_quad <- ggplot(dados_reg, aes(x = dose, y = prod)) +
  geom_point(size = 3) +
  stat_smooth(
    method = "lm",
    formula = y ~ x + I(x^2),
    se = FALSE,
    color = "black"
  ) +
  annotate("text", x = 50, y = 10, label = legenda, hjust = 0, size = 5) +
  labs(x = "Dose", y = "Produ√ß√£o") +
  theme_bw() +
  theme(panel.grid = element_blank()) +
  ylim(0, 50)

# Exibir gr√°fico
regressao_quad

```

## üîπ M√≥dulo 5 ‚Äì Relat√≥rios e Projeto Final

### Aula 15 ‚Äì Relat√≥rios com RMarkdown

-   Este pr√≥prio arquivo √© um exemplo.\
-   Pode ser exportado em HTML, Word ou PDF.

------------------------------------------------------------------------

## ‚úÖ Projeto Final

Analise um conjunto de dados agr√≠colas (real ou fornecido):\
- Estruture os dados no Excel/CSV.\
- Importe para o R.\
- Realize ANOVA (com `aov()`, `ExpDes.pt`, `easyanova` e `rstatix`).\
- Teste pressupostos.\
- Se necess√°rio, ajuste modelos de regress√£o.\
- Gere gr√°ficos com `ggplot2`.\
- Organize os resultados em relat√≥rio RMarkdown.

------------------------------------------------------------------------
